---
layout: post
title: Python入门(中)
categories: Python
description: none
keywords: Python, 初学
---

这一部分大纲围绕着，字符串、列表、元组、字典这四大可迭代序列来描述。

## 列表

#### 1. 介绍

- 利用range()创建列表

```python
temp = list(range(10, 1, -2))
# 从10到1的，间隔2数的列表
empty = []
# 空列表
```

- 利用推导式创建列表

```python
x = [0] * 5
print(x, type(x))
# [0,0,0,0,0] <class list>
# 注意这是一个列表哦,而且类似于extend，而不是append
# 不是这样[[0],[0],[0],[0],[0]]
```

```python
a = [0] * 3  # [0,0,0]
x = [a] * 4  # [[0,0,0]] * 4
print(x, type(x))
# x =[[0,0,0],[0,0,0],[0,0,0],[0,0,0]] <class list>
print(8* [0,0,0]) #相当于空列表  []append  8个列表
# [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
```

**注意**：

- 由于list的元素可以是任何对象，因此列表中所保存的是对象的指针。即使保存一个简单的`[1,2,3]`，也有3个指针和3个整数对象。

- `x = [a] * 4`操作中，只是创建4个指向list的引用，所以一旦`a`改变，`x`中4个`a`也会随之改变。

- 列表的元素是可变的

#### 2. 基本方法

已知：

x = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']

| 方法名 |                             含义                             |          举例           | 结果                                                         |
| :----: | :----------------------------------------------------------: | :---------------------: | ------------------------------------------------------------ |
| append |                       添加单个**元素**                       | x.append(['123','456']) | ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', ['123','456']] |
| extend |         将另一个序列的所有值加入(类似于Java的addAll)         | x.extend(['123','456']) | ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', '123','456'] |
| insert |                     将元素插入到指定位置                     |    x.insert(2,'123')    | ['Monday', 'Tuesday', '123', 'Wednesday', 'Thursday', 'Friday'] |
| remove |                移除列表中某个值的第一个匹配项                |   x.remove('Monday')    | ['Tuesday', 'Wednesday', 'Thursday', 'Friday']               |
|  pop   | `list.pop([index=-1])` 移除列表中的一个元素（默认最后一个元素），并且返回该元素的值 |      y = x.pop(0)       | print(y)  # Monday                                           |

删除多个元素使用:

```python
del x[0:2]
print(x) # 剩下的元素  x[2:] 
```

获取元素

```python
print(x[0])
print(x[2:])
print(x[-1])
print(x[:3:1])
# 切片的通用写法是 start : stop : step
```

注意：

- `append` 是追加，把一个东西整体添加在列表后，而 `extend` 是扩展，把一个东西里的所有元素添加在列表后。
- remove和pop的区别：`remove` 和 `pop` 都可以删除元素，前者是指定具体要删除的元素，后者是指定一个索引。

【举例】请将列表x=['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'],按照倒叙排列

```python
print(x[::-1]) # 即x[0:len(x):-1]   
# 切片的通用写法是 start : stop : step
# 如果start是0，stop是最后一个，可以省略，所以变成了x[:]
# 步长为-1，即从最后一个数开始往回找
```
#### 3. 浅拷贝和深拷贝

```python
list1 = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday']
list2 = list1 # 浅拷贝,如果list1的元素发生改变，那么list2也会跟着变动
list3 = list1[:] # 深拷贝，不会发生变动
# 当我们希望改变列表中的元素，而不影响原列表的时候，就使用深拷贝
```

#### 4. 列表中的常用操作符

- 等号操作符：`==`  
- 连接操作符 `+`   # extend()
- 重复操作符 `*`   # x = a * 3
- 成员关系操作符 `in`、`not in`

注意：

append, extend, insert可对列表增加元素，它们没有返回值，是直接修改了原数据对象

而将两个list相加，需要创建新的 list 对象，从而需要消耗额外的内存;所以建议使用extend

#### 5. 额外方法

```python 
list.count(obj) # 统计某个元素在列表中的次数

list.index(obj,0) # 返回元素出现的第一个位置,0是start开始位置
list.index(obj,3, 7) # 返回元素出现的第一个位置，从下标3到7

list.reverse() # 反向列表中元素 [::-1]
list.sort(key=None, reverse=False) # 对原列表进行排序。默认为False，升序
```

【例题】马上分寝室了，请根据姓名进行正序排列来分寝室；请根据年龄排序来查看年龄分布情况。

```python
# list=[(名称，年龄)，..]
list1 = [('张三',23),('李四',24),('王五',25),('赵六',26),('孙七',27),('周八',28),('吴九',29),('郑十',30)]
# 根据姓名进行排序，第一种：自己写一个方法

# list1中每一个元素都是一个元组
def get_elem_one(name_age_tuple):
    return name_age_tuple[0]

# 分寝室
list1.sort(key=get_elem_one,reverse=True)
print(list1)

# 查看年龄分布
list1.sort(key=lambda x:x[1])
print(list1)
```



## 元组

元组一旦创建，就不允许进行修改了，就像str

```python
t1 = (1, 10.31, 'python')
t2 = 1, 10.31, 'python'
# 以上两个都是元组哦！！！
```

获取元素的用法和列表完全相同，也可以进行切片

注意：

- 元组中只包含一个元素时，需要在元素后面添加逗号，否则括号会被当作运算符使用。

```python
x = (1)
# print(type(x)) <class 'int'>
x = ()
# print(type(x)) <class 'tuple'>
x = (1,)
# print(type(x)) <class 'tuple'>
print(8 * (8))  # 64
print(8 * (8,))  # (8, 8, 8, 8, 8, 8, 8, 8)

print(4 * (8,6)) # (8, 6, 8, 6, 8, 6, 8, 6)
print(4 * ((8,6))) # (8, 6, 8, 6, 8, 6, 8, 6)
print(4 * [[8,6]]) # [[8, 6], [8, 6], [8, 6], [8, 6]]
# 列表和元组这里是有区别的哦
```

元组是不可更改的,但是元组的元素如果是可变的，那么该元素就可变

同时，可以以深拷贝的方式重新创建一个新的元组

```python
week = ('Monday', 'Tuesday', 'Thursday', ['Friday','Saturday', 'Sunday'])
week[2] = 'Wednesday'
# TypeError: 'tuple' object does not support item assignment
week[3][0] = '123' # 正常执行

week = week[:2] + ('Wednesday',) + week[2:]
# 注意哦，因为前后都是元组，+的自然也是元组，所以必须要打括号，而且因为是一个元素，必须加上逗号
```

#### 1. 基本方法：

```python
t = (1, 10.31, 'python')
print(t.count('python'))  # 1
print(t.index(10.31))  # 1
```

#### 2. 解压元组

```python
# 一个function的函数，有三个返回值，比如姓名，年龄，电话
def function():
	# 方法体
    # return name,age,tel_num
    t = '张三', 29, '23453451'
    return t

(name,age,tel_num) = function() 
# 当然，更常见的写法是   name,age,tel_num = function() 

# 元素多了怎么办，比如我利用select * 返回的所有列表，但是只想取其中几个元素
# function返回的列表假设为t = 1, 2, 3, 4, 5
# 只关注前两个数
(name,age, *rest) = function() # 把多个元素丢给了 `rest` 变量。
# 或者：
name, age, *_ = t  
# 如果我们不关心rest变量，那么都不用取变量名，直接使用下划线代替
```



## 字符串

字符串和元组相同，都是不可变的
| 转义字符 | 描述            |
| :------: | --------------- |
|   `\\`   | 反斜杠符号      |
|   `\'`   | 单引号          |
|   `\"`   | 双引号          |
|   `\n`   | 换行            |
|   `\t`   | 横向制表符(TAB) |
|   `\r`   | 回车            |

【例子】原始字符串只需要在字符串前边加一个英文字母 r 即可。

```python
print(r'C:\Program Files\Intel\Wifi\Help')  
# C:\Program Files\Intel\Wifi\Help
```

#### 1. 常用方法

- `capitalize()` 将字符串的第一个字符转换为大写。
- `lower()` 转换字符串中所有大写字符为小写。
- `upper()` 转换字符串中的小写字母为大写。
- `swapcase()` 将字符串中大写转换为小写，小写转换为大写。
- `count(str, beg= 0,end=len(string))` 返回`str`在 string 里面出现的次数，如果`beg`或者`end`指定则返回指定范围内`str`出现的次数。
- `endswith(suffix, beg=0, end=len(string))`
- `startswith(substr, beg=0,end=len(string))`
- `find(str, beg=0, end=len(string))`
- `rfind(str, beg=0,end=len(string))`
- `isnumeric()` 如果字符串中只包含数字字符，则返回 True，否则返回 False。
- `ljust(width[, fillchar])`返回一个原字符串左对齐，并使用`fillchar`（默认空格）填充至长度`width`的新字符串。
- `rjust(width[, fillchar])`返回一个原字符串右对齐，并使用`fillchar`（默认空格）填充至长度`width`的新字符串。(这两个方法常用于设置日标，比如20240430  + 0001，凑足12位)
- `lstrip([chars])` 截掉字符串左边的空格或指定字符。
- `rstrip([chars])` 删除字符串末尾的空格或指定字符。
- `strip([chars])` 在字符串上执行`lstrip()`和`rstrip()`。
- `partition(sub)` 找到子字符串sub，把字符串分为一个三元组`(pre_sub,sub,fol_sub)`，如果字符串中不包含sub则返回`('原字符串','','')`。
- `rpartition(sub)`类似于`partition()`方法，不过是从右边开始查找。
- `replace(old, new [, max])` 把 将字符串中的`old`替换成`new`，如果`max`指定，则替换不超过`max`次。
- `split(str="", num)` 不带参数默认是以空格为分隔符切片字符串，如果`num`参数有设置，则仅分隔`num`个子字符串，返回切片后的子字符串拼接的列表。
- `splitlines([keepends])` 按照行('\r', '\r\n', \n')分隔，返回一个包含各行作为元素的列表，如果参数`keepends`为 False，不包含换行符，如果为 True，则保留换行符。

注意：这些方法是在使用中去进行运用的，不用去记忆

#### 2. 字符串格式化

```python
str8 = "{0} Love {1}".format('I', 'Lsgogroup')  # 位置参数
str8 = "{a} Love {b}".format(a='I', b='Lsgogroup')  # 关键字参数
# 注意，不建议两个混着用，只使用其中一个
str8 = '{0:.2f}{1}'.format(27.658, 'GB')  # 保留小数点后两位
# '{0:.2f}'表示含义：  0表示第一个元素，   :表示对第一个元素进行额外操作   .2f保留两位小数
```

#### 3. 常用方法的举例使用

```python

# 【例1】请获取ip和端口号，并组装为ip:port的形式

# 已知：url = 'ws://43.136.78.74:6500/websocket/e9ca23d68d884d4ebb19d07889727dae_ddb8c6172d3b37b2aaee0c8bc4ce4a67'

real_ip = url.split('//', 1)[1].split('/', 1)[0]
real_url = 'https://' + real_ip
print(real_url)

# 【例2】请将以下GPT的流式响应，提取出ai响应的内容
# 已知：
'''
...
event: moduleStatus
data: {"status":"running","name":"core.module.template.Http request"}

event: answer
data: {"id":"","object":"","created":0,"model":"","choices":[{"delta":{},"index":0,"finish_reason":"stop"}]}

event: answer
data: [DONE]

event: appStreamResponse
data: [{"moduleName":"问题分类","moduleType":"classifyQuestion","price":0,"model":"GPT35","query":"{\"content\":\"社区电话是多少\",\"seq\":\"3Uwc8CD4AcaL2ezHep8G\",\"type\":\"001\"}","inputTokens":228,"outputTokens":6,"cqList":[{"value":"事件：这句话在说一个事件","key":"wqre"},{"value":"咨询：这句话在问一个问题","key":"sdfa"},{"value":"质疑政府，如：政府干啥吃的？","key":"zhpl"},{"value":"其他","key":"ja1j"}],"cqResult":"咨询：这句话在问一个问题","contextTotalLen":2,"runningTime":0.81},{"moduleName":"core.module.template.Extract field","moduleType":"contentExtract","price":0,"model":"GPT35-1106","query":"{\"content\":\"社区电话是多少\",\"seq\":\"3Uwc8CD4AcaL2ezHep8G\",\"type\":\"001\"}","inputTokens":143,"outputTokens":28,"extractDescription":"1","extractResult":{"content":"社区电话是多少","seq":"3Uwc8CD4AcaL2ezHep8G"},"contextTotalLen":2,"runningTime":1.45},{"moduleName":"知识库搜索","moduleType":"datasetSearchNode","price":0,"query":"社区电话是多少","model":"M3E","charsLength":7,"similarity":0.43,"limit":1500,"searchMode":"embedding","searchUsingReRank":false,"runningTime":0.42},{"moduleName":"AI 对话","moduleType":"chatNode","price":0,"model":"chatglm_std","inputTokens":243,"outputTokens":21,"query":"社区电话是多少","maxToken":2000,"quoteList":[{"id":"65b201a775d9583c957af9cc","q":"社区电话：62153911\n\n社区地址：星空路一段178号\n\n社区医院地址：星空路一段201号\n\n星空物业地址及电话：星空路一段250号；电话62153912\n\n社区便民中心地址：康安路星空花园—B区西南侧\n","a":"","chunkIndex":0,"datasetId":"65b0d42175d9583c957add76","collectionId":"65b201a675d9583c957af9b3","sourceName":"社区信息.docx","sourceId":"65b201a675d9583c957af9b1","score":[{"type":"embedding","value":0.511782169342041,"index":0}]}],"historyPreview":[{"obj":"Human","value":"使用<data></data>标记的内容作为你的知识：\n\n<data>\n社区电话：62153911\n\n社区地址：星空路一段178号\n\n社区医院地址：星空路一段201号\n\n星空物业地址及电话：星空路一段250号；电话62153912\n\n社区便民中心地址：康安路星空花园—B区西南侧\n\n    \n</data>\n\n回答要求：\n- 回答中不要出现“根据提供的知识”或类似的话。\n- 回答不要出现“根据您提供的数据”或类似的话。\n- 如果你不清楚答案，不做任何回复。\n- 不要提及任何和data有关的东西。\n- 保持答案与data中描述的一致。\n- 使用与问题相同的语言回答。\n\n问题：\"社区电话是多少\""},{"obj":"AI","value":"  社区电话是62153911。\n"}],"contextTotalLen":2,"runningTime":2.55},{"moduleName":"core.module.template.Http request","moduleType":"httpRequest","price":0,"body":{"appId":"6620e7c3d3f0183380ff2d90","chatId":"iulvdknswzix","responseChatItemId":"dkzady425e8kzzi9betwjwkc","variables":{"cTime":"2024-05-06 17:25:56"},"data":{"content":"  社区电话是62153911。\n","seq":"3Uwc8CD4AcaL2ezHep8G"}},"httpResult":{"success":true,"message":"","code":200,"result":null,"timestamp":1714987562178},"runningTime":0.13}]
'''
# 文件内容读取方式如下：
with open("json.txt", "r", encoding='utf-8') as f:
    for line in f.readlines():
        print(line)

```

